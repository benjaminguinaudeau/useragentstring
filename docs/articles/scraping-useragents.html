<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>What are the best user agents for web scraping? • useragentstring</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="What are the best user agents for web scraping?">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">useragentstring</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/eda.html">Exploratory Data Analysis of User Agent Strings</a></li>
    <li><a class="dropdown-item" href="../articles/scraping-useragents.html">What are the best user agents for web scraping?</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/benjaminguinaudeau/useragentstring"><span class="fa fab fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>What are the best user agents for web scraping?</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/benjaminguinaudeau/useragentstring/blob/HEAD/vignettes/scraping-useragents.Rmd" class="external-link"><code>vignettes/scraping-useragents.Rmd</code></a></small>
      <div class="d-none name"><code>scraping-useragents.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://forcats.tidyverse.org/" class="external-link">forcats</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org" class="external-link">scales</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>When web scraping, your user agent string is often the first thing a
website uses to determine whether to allow your request. Many sites
block requests from:</p>
<ul>
<li>Outdated browsers that real users don’t use anymore</li>
<li>Known bot/crawler user agents</li>
<li>Suspicious or malformed user agent strings</li>
</ul>
<p>This analysis tests user agents from our database against real
websites to answer:</p>
<ol style="list-style-type: decimal">
<li><strong>Do newer user agents get blocked less
frequently?</strong></li>
<li><strong>Which browsers have the lowest blocking rates?</strong></li>
<li><strong>What makes a “good” user agent for scraping?</strong></li>
</ol>
</div>
<div class="section level2">
<h2 id="methodology">Methodology<a class="anchor" aria-label="anchor" href="#methodology"></a>
</h2>
<div class="section level3">
<h3 id="test-sites">Test Sites<a class="anchor" aria-label="anchor" href="#test-sites"></a>
</h3>
<p>We test user agents against websites with varying levels of bot
protection:</p>
<table class="table">
<colgroup>
<col width="18%">
<col width="21%">
<col width="59%">
</colgroup>
<thead><tr class="header">
<th>Tier</th>
<th>Sites</th>
<th>Expected Behavior</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Baseline</td>
<td>httpbin.org</td>
<td>Always accepts (control)</td>
</tr>
<tr class="even">
<td>Standard</td>
<td>google.com, bing.com, wikipedia.org</td>
<td>Basic bot filtering</td>
</tr>
<tr class="odd">
<td>Moderate</td>
<td>amazon.com, reddit.com</td>
<td>Cookie/JS checks</td>
</tr>
<tr class="even">
<td>Strict</td>
<td>linkedin.com, cloudflare.com, instagram.com</td>
<td>Aggressive bot detection</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="blocking-detection">Blocking Detection<a class="anchor" aria-label="anchor" href="#blocking-detection"></a>
</h3>
<p>A request is classified as “blocked” if:</p>
<ul>
<li>HTTP status code is 403, 429, 503, or 406</li>
<li>Response contains patterns like “captcha”, “blocked”, “verify you
are human”</li>
<li>Response is suspiciously small with fast response time</li>
</ul>
</div>
<div class="section level3">
<h3 id="blocking-score">Blocking Score<a class="anchor" aria-label="anchor" href="#blocking-score"></a>
</h3>
<p>Each user agent receives a score from 0-100:</p>
<ul>
<li>
<strong>0-25</strong>: Heavily blocked (avoid)</li>
<li>
<strong>25-50</strong>: Frequently blocked (risky)</li>
<li>
<strong>50-75</strong>: Occasionally blocked (usable with
caution)</li>
<li>
<strong>75-100</strong>: Rarely blocked (recommended for
scraping)</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="data-preparation">Data Preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load all RDS files from data folder</span></span>
<span><span class="va">data_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="st">"../data"</span>, pattern <span class="op">=</span> <span class="st">"\\.rds$"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load and combine (ensure consistent date types)</span></span>
<span><span class="va">all_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">data_files</span>, <span class="kw">function</span><span class="op">(</span><span class="va">f</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">first_visit</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">first_visit</span>, <span class="st">"POSIXct"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">d</span><span class="op">$</span><span class="va">first_visit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">first_visit</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">last_visit</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">last_visit</span>, <span class="st">"POSIXct"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">d</span><span class="op">$</span><span class="va">last_visit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">last_visit</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">d</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">useragent_string</span>, .keep_all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">useragent_string</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Also load the CSV if available</span></span>
<span><span class="va">csv_file</span> <span class="op">&lt;-</span> <span class="st">"../user_agents.csv"</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">csv_file</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">csv_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">csv_file</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">csv_data</span><span class="op">$</span><span class="va">first_visit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="va">csv_data</span><span class="op">$</span><span class="va">first_visit</span><span class="op">)</span></span>
<span>  <span class="va">csv_data</span><span class="op">$</span><span class="va">last_visit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="va">csv_data</span><span class="op">$</span><span class="va">last_visit</span><span class="op">)</span></span>
<span>  <span class="va">all_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">all_data</span>, <span class="va">csv_data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">useragent_string</span>, .keep_all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Total unique user agents:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">all_data</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Total unique user agents: 5473</span></span></code></pre></div>
<div class="section level3">
<h3 id="sampling-strategy">Sampling Strategy<a class="anchor" aria-label="anchor" href="#sampling-strategy"></a>
</h3>
<p>We sample user agents stratified by:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Recency</strong> (based on last_visit): How recently was
this UA seen in the wild?</li>
<li>
<strong>Browser type</strong>: Chrome, Firefox, Safari, Opera, Edge,
crawlers</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create recency bins</span></span>
<span><span class="va">sample_data</span> <span class="op">&lt;-</span> <span class="va">all_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">last_visit</span><span class="op">)</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">useragent_string</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    days_since_seen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/difftime.html" class="external-link">difftime</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">last_visit</span>, units <span class="op">=</span> <span class="st">"days"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    recency_bin <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">days_since_seen</span> <span class="op">&lt;=</span> <span class="fl">30</span> <span class="op">~</span> <span class="st">"Last 30 days"</span>,</span>
<span>      <span class="va">days_since_seen</span> <span class="op">&lt;=</span> <span class="fl">180</span> <span class="op">~</span> <span class="st">"1-6 months"</span>,</span>
<span>      <span class="va">days_since_seen</span> <span class="op">&lt;=</span> <span class="fl">365</span> <span class="op">~</span> <span class="st">"6-12 months"</span>,</span>
<span>      <span class="va">days_since_seen</span> <span class="op">&lt;=</span> <span class="fl">1095</span> <span class="op">~</span> <span class="st">"1-3 years"</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"3+ years"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    recency_bin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">recency_bin</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Last 30 days"</span>, <span class="st">"1-6 months"</span>, <span class="st">"6-12 months"</span>, <span class="st">"1-3 years"</span>, <span class="st">"3+ years"</span></span>
<span>    <span class="op">)</span><span class="op">)</span>,</span>
<span>    browser_type <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">browser</span>, <span class="fu"><a href="https://stringr.tidyverse.org/reference/modifiers.html" class="external-link">regex</a></span><span class="op">(</span><span class="st">"bot|spider|crawler"</span>, ignore_case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Crawler"</span>,</span>
<span>      <span class="va">browser</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Chrome"</span>, <span class="st">"Firefox"</span>, <span class="st">"Safari"</span>, <span class="st">"Opera"</span>, <span class="st">"Edge"</span><span class="op">)</span> <span class="op">~</span> <span class="va">browser</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Other"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Sample from each stratum</span></span>
<span><span class="va">n_per_stratum</span> <span class="op">&lt;-</span> <span class="fl">8</span></span>
<span></span>
<span><span class="va">sampled_ua</span> <span class="op">&lt;-</span> <span class="va">sample_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">recency_bin</span>, <span class="va">browser_type</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_per_stratum</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Sampled"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sampled_ua</span><span class="op">)</span>, <span class="st">"user agents for testing\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sampled 231 user agents for testing</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Visualize sample distribution</span></span>
<span><span class="va">sample_dist</span> <span class="op">&lt;-</span> <span class="va">sampled_ua</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">recency_bin</span>, <span class="va">browser_type</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sample_dist</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">recency_bin</span>, y <span class="op">=</span> <span class="va">n</span>, fill <span class="op">=</span> <span class="va">browser_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Sample Distribution"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"User agents selected for blocking test"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Recency (last seen)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Count"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"Browser"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="scraping-useragents_files/figure-html/sample-distribution-1.png" width="768"></p>
</div>
</div>
<div class="section level2">
<h2 id="running-the-blocking-tests">Running the Blocking Tests<a class="anchor" aria-label="anchor" href="#running-the-blocking-tests"></a>
</h2>
<p>We test each sampled user agent against our test sites. This takes
approximately 15-20 minutes.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define test sites</span></span>
<span><span class="va">test_sites</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"https://httpbin.org/user-agent"</span>,</span>
<span>  <span class="st">"https://www.google.com/"</span>,</span>
<span>  <span class="st">"https://www.bing.com/"</span>,</span>
<span>  <span class="st">"https://en.wikipedia.org/"</span>,</span>
<span>  <span class="st">"https://www.amazon.com/"</span>,</span>
<span>  <span class="st">"https://www.reddit.com/"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Function to test a single UA</span></span>
<span><span class="va">test_single_ua</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">ua_string</span>, <span class="va">sites</span>, <span class="va">delay</span> <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">sites</span>, <span class="kw">function</span><span class="op">(</span><span class="va">site</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">start_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">result</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span><span class="op">{</span></span>
<span>      <span class="va">resp</span> <span class="op">&lt;-</span> <span class="fu">httr2</span><span class="fu">::</span><span class="fu"><a href="https://httr2.r-lib.org/reference/request.html" class="external-link">request</a></span><span class="op">(</span><span class="va">site</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">httr2</span><span class="fu">::</span><span class="fu"><a href="https://httr2.r-lib.org/reference/req_headers.html" class="external-link">req_headers</a></span><span class="op">(</span><span class="st">"User-Agent"</span> <span class="op">=</span> <span class="va">ua_string</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">httr2</span><span class="fu">::</span><span class="fu"><a href="https://httr2.r-lib.org/reference/req_headers.html" class="external-link">req_headers</a></span><span class="op">(</span><span class="st">"Accept"</span> <span class="op">=</span> <span class="st">"text/html,application/xhtml+xml"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">httr2</span><span class="fu">::</span><span class="fu"><a href="https://httr2.r-lib.org/reference/req_headers.html" class="external-link">req_headers</a></span><span class="op">(</span><span class="st">"Accept-Language"</span> <span class="op">=</span> <span class="st">"en-US,en;q=0.9"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">httr2</span><span class="fu">::</span><span class="fu"><a href="https://httr2.r-lib.org/reference/req_timeout.html" class="external-link">req_timeout</a></span><span class="op">(</span><span class="fl">15</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">httr2</span><span class="fu">::</span><span class="fu"><a href="https://httr2.r-lib.org/reference/req_perform.html" class="external-link">req_perform</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>      <span class="va">status</span> <span class="op">&lt;-</span> <span class="fu">httr2</span><span class="fu">::</span><span class="fu"><a href="https://httr2.r-lib.org/reference/resp_status.html" class="external-link">resp_status</a></span><span class="op">(</span><span class="va">resp</span><span class="op">)</span></span>
<span>      <span class="va">content</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span><span class="fu">httr2</span><span class="fu">::</span><span class="fu"><a href="https://httr2.r-lib.org/reference/resp_body_raw.html" class="external-link">resp_body_string</a></span><span class="op">(</span><span class="va">resp</span><span class="op">)</span>, error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="st">""</span><span class="op">)</span></span>
<span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>status <span class="op">=</span> <span class="va">status</span>, content <span class="op">=</span> <span class="va">content</span>, error <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="op">}</span>, error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>status <span class="op">=</span> <span class="cn">NA</span>, content <span class="op">=</span> <span class="st">""</span>, error <span class="op">=</span> <span class="cn">TRUE</span>, msg <span class="op">=</span> <span class="va">e</span><span class="op">$</span><span class="va">message</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">response_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/difftime.html" class="external-link">difftime</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">start_time</span>, units <span class="op">=</span> <span class="st">"secs"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="va">delay</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Detect blocking</span></span>
<span>    <span class="va">blocked</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span>    <span class="va">reason</span> <span class="op">&lt;-</span> <span class="st">"OK"</span></span>
<span>    <span class="va">score</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">error</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">blocked</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span>      <span class="va">reason</span> <span class="op">&lt;-</span> <span class="st">"Connection error"</span></span>
<span>      <span class="va">score</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">status</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">403</span>, <span class="fl">429</span>, <span class="fl">503</span>, <span class="fl">406</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">blocked</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span>      <span class="va">reason</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"HTTP "</span>, <span class="va">result</span><span class="op">$</span><span class="va">status</span><span class="op">)</span></span>
<span>      <span class="va">score</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">content_lower</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">content</span><span class="op">)</span></span>
<span>      <span class="va">blocking_patterns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"captcha"</span>, <span class="st">"blocked"</span>, <span class="st">"access denied"</span>,</span>
<span>                            <span class="st">"verify you are human"</span>, <span class="st">"security check"</span><span class="op">)</span></span>
<span>      <span class="kw">for</span> <span class="op">(</span><span class="va">pattern</span> <span class="kw">in</span> <span class="va">blocking_patterns</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">content_lower</span>, <span class="va">pattern</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>          <span class="va">blocked</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span>          <span class="va">reason</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Pattern: "</span>, <span class="va">pattern</span><span class="op">)</span></span>
<span>          <span class="va">score</span> <span class="op">&lt;-</span> <span class="fl">0.25</span></span>
<span>          <span class="kw">break</span></span>
<span>        <span class="op">}</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>      site <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">site</span><span class="op">)</span>,</span>
<span>      status <span class="op">=</span> <span class="va">result</span><span class="op">$</span><span class="va">status</span>,</span>
<span>      response_time <span class="op">=</span> <span class="va">response_time</span>,</span>
<span>      blocked <span class="op">=</span> <span class="va">blocked</span>,</span>
<span>      reason <span class="op">=</span> <span class="va">reason</span>,</span>
<span>      score <span class="op">=</span> <span class="va">score</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Run tests on all sampled UAs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Testing"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sampled_ua</span><span class="op">)</span>, <span class="st">"user agents against"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">test_sites</span><span class="op">)</span>, <span class="st">"sites...\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Testing 231 user agents against 6 sites...</span></span>
<span></span>
<span><span class="va">all_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sampled_ua</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">i</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">10</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Progress:"</span>, <span class="va">i</span>, <span class="st">"/"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sampled_ua</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">ua</span> <span class="op">&lt;-</span> <span class="va">sampled_ua</span><span class="op">$</span><span class="va">useragent_string</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">site_results</span> <span class="op">&lt;-</span> <span class="fu">test_single_ua</span><span class="op">(</span><span class="va">ua</span>, <span class="va">test_sites</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">all_results</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>    browser <span class="op">=</span> <span class="va">sampled_ua</span><span class="op">$</span><span class="va">browser</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>    browser_type <span class="op">=</span> <span class="va">sampled_ua</span><span class="op">$</span><span class="va">browser_type</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>    version <span class="op">=</span> <span class="va">sampled_ua</span><span class="op">$</span><span class="va">version</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>    recency_bin <span class="op">=</span> <span class="va">sampled_ua</span><span class="op">$</span><span class="va">recency_bin</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>    days_since_seen <span class="op">=</span> <span class="va">sampled_ua</span><span class="op">$</span><span class="va">days_since_seen</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>    useragent_string <span class="op">=</span> <span class="va">ua</span>,</span>
<span>    blocking_score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">site_results</span><span class="op">$</span><span class="va">score</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>    n_blocked <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">site_results</span><span class="op">$</span><span class="va">blocked</span><span class="op">)</span>,</span>
<span>    n_sites <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">site_results</span><span class="op">)</span>,</span>
<span>    avg_response_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">site_results</span><span class="op">$</span><span class="va">response_time</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Progress: 10 / 231 </span></span>
<span><span class="co">#&gt; Progress: 20 / 231 </span></span>
<span><span class="co">#&gt; Progress: 30 / 231 </span></span>
<span><span class="co">#&gt; Progress: 40 / 231 </span></span>
<span><span class="co">#&gt; Progress: 50 / 231 </span></span>
<span><span class="co">#&gt; Progress: 60 / 231 </span></span>
<span><span class="co">#&gt; Progress: 70 / 231 </span></span>
<span><span class="co">#&gt; Progress: 80 / 231 </span></span>
<span><span class="co">#&gt; Progress: 90 / 231 </span></span>
<span><span class="co">#&gt; Progress: 100 / 231 </span></span>
<span><span class="co">#&gt; Progress: 110 / 231 </span></span>
<span><span class="co">#&gt; Progress: 120 / 231 </span></span>
<span><span class="co">#&gt; Progress: 130 / 231 </span></span>
<span><span class="co">#&gt; Progress: 140 / 231 </span></span>
<span><span class="co">#&gt; Progress: 150 / 231 </span></span>
<span><span class="co">#&gt; Progress: 160 / 231 </span></span>
<span><span class="co">#&gt; Progress: 170 / 231 </span></span>
<span><span class="co">#&gt; Progress: 180 / 231 </span></span>
<span><span class="co">#&gt; Progress: 190 / 231 </span></span>
<span><span class="co">#&gt; Progress: 200 / 231 </span></span>
<span><span class="co">#&gt; Progress: 210 / 231 </span></span>
<span><span class="co">#&gt; Progress: 220 / 231 </span></span>
<span><span class="co">#&gt; Progress: 230 / 231</span></span>
<span></span>
<span><span class="va">test_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">all_results</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Testing complete!\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Testing complete!</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h2>
<div class="section level3">
<h3 id="overall-blocking-score-distribution">Overall Blocking Score Distribution<a class="anchor" aria-label="anchor" href="#overall-blocking-score-distribution"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">test_results</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">blocking_score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">20</span>, fill <span class="op">=</span> <span class="st">"steelblue"</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">test_results</span><span class="op">$</span><span class="va">blocking_score</span><span class="op">)</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Distribution of Blocking Scores"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Mean score: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">test_results</span><span class="op">$</span><span class="va">blocking_score</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                     <span class="st">" (red line). Higher = less blocked"</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Blocking Score (0-100)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Count"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">25</span>, y <span class="op">=</span> <span class="cn">Inf</span>, vjust <span class="op">=</span> <span class="fl">2</span>,</span>
<span>           label <span class="op">=</span> <span class="st">"Heavily\nBlocked"</span>, color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">87</span>, y <span class="op">=</span> <span class="cn">Inf</span>, vjust <span class="op">=</span> <span class="fl">2</span>,</span>
<span>           label <span class="op">=</span> <span class="st">"Rarely\nBlocked"</span>, color <span class="op">=</span> <span class="st">"darkgreen"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="scraping-useragents_files/figure-html/score-distribution-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="blocking-rate-by-user-agent-age">Blocking Rate by User Agent Age<a class="anchor" aria-label="anchor" href="#blocking-rate-by-user-agent-age"></a>
</h3>
<p><strong>Key Question</strong>: Do more recent user agents get blocked
less?</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Scatter plot with regression</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">test_results</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">days_since_seen</span>, y <span class="op">=</span> <span class="va">blocking_score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">browser_type</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.6</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">TRUE</span>, color <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"User Agent Age vs. Blocking Score"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Do newer user agents get blocked less?"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Days Since Last Seen (log scale)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Blocking Score (higher = better)"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Browser"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span></span></code></pre></div>
<p><img src="scraping-useragents_files/figure-html/age-analysis-1.png" width="768"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Statistical test</span></span>
<span><span class="va">correlation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html" class="external-link">cor.test</a></span><span class="op">(</span><span class="va">test_results</span><span class="op">$</span><span class="va">days_since_seen</span>, <span class="va">test_results</span><span class="op">$</span><span class="va">blocking_score</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Correlation between UA age and blocking score:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Correlation between UA age and blocking score:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Pearson r ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">correlation</span><span class="op">$</span><span class="va">estimate</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Pearson r = 0.17</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  p-value ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">correlation</span><span class="op">$</span><span class="va">p.value</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   p-value = 0.00943</span></span>
<span></span>
<span><span class="co"># Linear regression</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">blocking_score</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">days_since_seen</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">test_results</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nRegression summary:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regression summary:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  For every 10x increase in UA age, blocking score changes by"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"points\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   For every 10x increase in UA age, blocking score changes by 0.53 points</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="blocking-rate-by-recency-bin">Blocking Rate by Recency Bin<a class="anchor" aria-label="anchor" href="#blocking-rate-by-recency-bin"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">recency_summary</span> <span class="op">&lt;-</span> <span class="va">test_results</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">recency_bin</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    mean_score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">blocking_score</span><span class="op">)</span>,</span>
<span>    median_score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">blocking_score</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">test_results</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">recency_bin</span>, y <span class="op">=</span> <span class="va">blocking_score</span>, fill <span class="op">=</span> <span class="va">recency_bin</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.2</span>, alpha <span class="op">=</span> <span class="fl">0.3</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Blocking Score by User Agent Recency"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"More recent user agents tend to have higher success rates"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"When User Agent Was Last Seen"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Blocking Score (higher = better)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"RdYlGn"</span>, direction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="scraping-useragents_files/figure-html/recency-boxplot-1.png" width="768"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ANOVA test</span></span>
<span><span class="va">anova_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">blocking_score</span> <span class="op">~</span> <span class="va">recency_bin</span>, data <span class="op">=</span> <span class="va">test_results</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"ANOVA: Blocking score by recency bin\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ANOVA: Blocking score by recency bin</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  F-value:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">anova_result</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"F value"</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   F-value: 2.02</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  p-value:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">anova_result</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"Pr(&gt;F)"</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   p-value: 0.0919</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">recency_summary</span>,</span>
<span>             col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Recency"</span>, <span class="st">"Mean Score"</span>, <span class="st">"Median Score"</span>, <span class="st">"N"</span><span class="op">)</span>,</span>
<span>             digits <span class="op">=</span> <span class="fl">1</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Blocking Score Summary by Recency"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Blocking Score Summary by Recency</caption>
<thead><tr class="header">
<th align="left">Recency</th>
<th align="right">Mean Score</th>
<th align="right">Median Score</th>
<th align="right">N</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Last 30 days</td>
<td align="right">56.9</td>
<td align="right">54.2</td>
<td align="right">43</td>
</tr>
<tr class="even">
<td align="left">1-6 months</td>
<td align="right">56.5</td>
<td align="right">50.0</td>
<td align="right">49</td>
</tr>
<tr class="odd">
<td align="left">6-12 months</td>
<td align="right">54.6</td>
<td align="right">50.0</td>
<td align="right">46</td>
</tr>
<tr class="even">
<td align="left">1-3 years</td>
<td align="right">57.1</td>
<td align="right">62.5</td>
<td align="right">46</td>
</tr>
<tr class="odd">
<td align="left">3+ years</td>
<td align="right">58.6</td>
<td align="right">62.5</td>
<td align="right">47</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="blocking-rate-by-browser">Blocking Rate by Browser<a class="anchor" aria-label="anchor" href="#blocking-rate-by-browser"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">browser_summary</span> <span class="op">&lt;-</span> <span class="va">test_results</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">browser_type</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    mean_score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">blocking_score</span><span class="op">)</span>,</span>
<span>    median_score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">blocking_score</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">mean_score</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">test_results</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_reorder.html" class="external-link">fct_reorder</a></span><span class="op">(</span><span class="va">browser_type</span>, <span class="va">blocking_score</span>, .fun <span class="op">=</span> <span class="va">median</span><span class="op">)</span>,</span>
<span>                         y <span class="op">=</span> <span class="va">blocking_score</span>, fill <span class="op">=</span> <span class="va">browser_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.2</span>, alpha <span class="op">=</span> <span class="fl">0.4</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Blocking Score by Browser Type"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Which browsers are least likely to be blocked?"</span>,</span>
<span>    x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Blocking Score (higher = better)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="scraping-useragents_files/figure-html/browser-comparison-1.png" width="768"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">browser_summary</span>,</span>
<span>             col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Browser"</span>, <span class="st">"Mean Score"</span>, <span class="st">"Median Score"</span>, <span class="st">"N"</span><span class="op">)</span>,</span>
<span>             digits <span class="op">=</span> <span class="fl">1</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Blocking Score by Browser Type"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Blocking Score by Browser Type</caption>
<thead><tr class="header">
<th align="left">Browser</th>
<th align="right">Mean Score</th>
<th align="right">Median Score</th>
<th align="right">N</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Other</td>
<td align="right">62.5</td>
<td align="right">62.5</td>
<td align="right">33</td>
</tr>
<tr class="even">
<td align="left">Crawler</td>
<td align="right">60.0</td>
<td align="right">62.5</td>
<td align="right">18</td>
</tr>
<tr class="odd">
<td align="left">Opera</td>
<td align="right">58.4</td>
<td align="right">62.5</td>
<td align="right">40</td>
</tr>
<tr class="even">
<td align="left">Firefox</td>
<td align="right">56.6</td>
<td align="right">62.5</td>
<td align="right">40</td>
</tr>
<tr class="odd">
<td align="left">Safari</td>
<td align="right">55.0</td>
<td align="right">50.0</td>
<td align="right">40</td>
</tr>
<tr class="even">
<td align="left">Chrome</td>
<td align="right">53.1</td>
<td align="right">50.0</td>
<td align="right">40</td>
</tr>
<tr class="odd">
<td align="left">Edge</td>
<td align="right">51.9</td>
<td align="right">50.0</td>
<td align="right">20</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="browser-recency-interaction">Browser + Recency Interaction<a class="anchor" aria-label="anchor" href="#browser-recency-interaction"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interaction_data</span> <span class="op">&lt;-</span> <span class="va">test_results</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">browser_type</span>, <span class="va">recency_bin</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    mean_score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">blocking_score</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">interaction_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">recency_bin</span>, y <span class="op">=</span> <span class="va">browser_type</span>, fill <span class="op">=</span> <span class="va">mean_score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"white"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">mean_score</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"white"</span>, fontface <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Blocking Score: Browser x Recency"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Higher scores (greener) = less blocking"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"User Agent Recency"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Browser Type"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"Score"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient2</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"red"</span>, mid <span class="op">=</span> <span class="st">"yellow"</span>, high <span class="op">=</span> <span class="st">"darkgreen"</span>,</span>
<span>                       midpoint <span class="op">=</span> <span class="fl">50</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="scraping-useragents_files/figure-html/interaction-heatmap-1.png" width="768"></p>
</div>
</div>
<div class="section level2">
<h2 id="top-user-agents-for-scraping">Top User Agents for Scraping<a class="anchor" aria-label="anchor" href="#top-user-agents-for-scraping"></a>
</h2>
<p>Based on our analysis, these are the user agents with the highest
blocking scores:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_ua</span> <span class="op">&lt;-</span> <span class="va">test_results</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">blocking_score</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">browser</span>, <span class="va">version</span>, <span class="va">blocking_score</span>, <span class="va">recency_bin</span>, <span class="va">n_blocked</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">top_ua</span>,</span>
<span>             col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Browser"</span>, <span class="st">"Version"</span>, <span class="st">"Score"</span>, <span class="st">"Recency"</span>, <span class="st">"Sites Blocked"</span><span class="op">)</span>,</span>
<span>             digits <span class="op">=</span> <span class="fl">0</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Top 15 User Agents for Web Scraping"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Top 15 User Agents for Web Scraping</caption>
<thead><tr class="header">
<th align="left">Browser</th>
<th align="left">Version</th>
<th align="right">Score</th>
<th align="left">Recency</th>
<th align="right">Sites Blocked</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Opera</td>
<td align="left">8.02</td>
<td align="right">75</td>
<td align="left">Last 30 days</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">Opera</td>
<td align="left">8.65</td>
<td align="right">75</td>
<td align="left">Last 30 days</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">Opera</td>
<td align="left">7.23</td>
<td align="right">75</td>
<td align="left">1-6 months</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">Maxthon</td>
<td align="left">2.0</td>
<td align="right">75</td>
<td align="left">1-6 months</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">Opera</td>
<td align="left">10.51</td>
<td align="right">75</td>
<td align="left">1-3 years</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">Opera</td>
<td align="left">8.01</td>
<td align="right">75</td>
<td align="left">1-3 years</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">Opera</td>
<td align="left">8.0</td>
<td align="right">75</td>
<td align="left">3+ years</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">Chrome</td>
<td align="left">134.0.6998.166</td>
<td align="right">62</td>
<td align="left">Last 30 days</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">Chrome</td>
<td align="left">11.0.682.0</td>
<td align="right">62</td>
<td align="left">Last 30 days</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">Baiduspider</td>
<td align="left">2.0</td>
<td align="right">62</td>
<td align="left">Last 30 days</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">Baiduspider</td>
<td align="left">NA</td>
<td align="right">62</td>
<td align="left">Last 30 days</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">Edge</td>
<td align="left">18.18362</td>
<td align="right">62</td>
<td align="left">Last 30 days</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">Firefox</td>
<td align="left">120.0</td>
<td align="right">62</td>
<td align="left">Last 30 days</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">Firefox</td>
<td align="left">133.0</td>
<td align="right">62</td>
<td align="left">Last 30 days</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">Firefox</td>
<td align="left">137.0</td>
<td align="right">62</td>
<td align="left">Last 30 days</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="characteristics-of-best-user-agents">Characteristics of Best User Agents<a class="anchor" aria-label="anchor" href="#characteristics-of-best-user-agents"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Analyze what the top performers have in common</span></span>
<span><span class="va">top_20_pct</span> <span class="op">&lt;-</span> <span class="va">test_results</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">blocking_score</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">blocking_score</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Characteristics of top-performing user agents (top 20%):\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Characteristics of top-performing user agents (top 20%):</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Browser distribution:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Browser distribution:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">top_20_pct</span><span class="op">$</span><span class="va">browser_type</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Chrome Crawler    Edge Firefox   Opera   Other  Safari </span></span>
<span><span class="co">#&gt;      10      12       3      21      21      32      16</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nRecency distribution:\n</span></span>
<span><span class="st">"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Recency distribution:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">top_20_pct</span><span class="op">$</span><span class="va">recency_bin</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Last 30 days   1-6 months  6-12 months    1-3 years     3+ years </span></span>
<span><span class="co">#&gt;           20           23           17           24           31</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nMean days since seen:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">top_20_pct</span><span class="op">$</span><span class="va">days_since_seen</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mean days since seen: 858</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="recommendations">Recommendations<a class="anchor" aria-label="anchor" href="#recommendations"></a>
</h2>
<p>Based on our empirical testing:</p>
<div class="section level3">
<h3 id="use-recent-user-agents">1. Use Recent User Agents<a class="anchor" aria-label="anchor" href="#use-recent-user-agents"></a>
</h3>
<p>User agents seen in the <strong>last 6 months</strong> have
significantly higher success rates than older ones. Websites update
their bot detection regularly, and outdated UAs are often flagged. ###
2. Prefer Chrome and Firefox</p>
<p>These browsers have: - Highest market share (look “normal” to
detection systems) - Most consistent success across different sites -
Best performance on strict sites like LinkedIn and Cloudflare</p>
</div>
<div class="section level3">
<h3 id="avoid-crawler-user-agents">3. Avoid Crawler User Agents<a class="anchor" aria-label="anchor" href="#avoid-crawler-user-agents"></a>
</h3>
<p>Bot/crawler UAs (like Googlebot) are <strong>heavily blocked</strong>
on most commercial sites. Only use these when scraping sites that
explicitly allow bots.</p>
</div>
<div class="section level3">
<h3 id="rotate-user-agents">4. Rotate User Agents<a class="anchor" aria-label="anchor" href="#rotate-user-agents"></a>
</h3>
<p>Don’t use the same UA for all requests. Rotate among several recent,
high-scoring UAs to avoid pattern detection.</p>
</div>
<div class="section level3">
<h3 id="best-user-agent-strings-copy-paste-ready">Best User Agent Strings (Copy-Paste Ready)<a class="anchor" aria-label="anchor" href="#best-user-agent-strings-copy-paste-ready"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the actual best UA strings</span></span>
<span><span class="va">best_ua</span> <span class="op">&lt;-</span> <span class="va">test_results</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">blocking_score</span> <span class="op">&gt;=</span> <span class="fl">75</span>, <span class="va">browser_type</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Chrome"</span>, <span class="st">"Firefox"</span>, <span class="st">"Safari"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">blocking_score</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">useragent_string</span>, <span class="va">browser</span>, <span class="va">blocking_score</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Recommended user agents for scraping:\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Recommended user agents for scraping:</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">best_ua</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">i</span>, <span class="st">". ["</span>, <span class="va">best_ua</span><span class="op">$</span><span class="va">browser</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">" - Score: "</span>, <span class="va">best_ua</span><span class="op">$</span><span class="va">blocking_score</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">"]\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"   "</span>, <span class="va">best_ua</span><span class="op">$</span><span class="va">useragent_string</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="limitations">Limitations<a class="anchor" aria-label="anchor" href="#limitations"></a>
</h2>
<ol style="list-style-type: decimal">
<li><p><strong>Point-in-time snapshot</strong>: Websites update their
bot detection frequently. Results may vary over time.</p></li>
<li><p><strong>Geographic variation</strong>: Testing was done from a
single location. Some sites may behave differently based on IP
geolocation.</p></li>
<li><p><strong>Rate limiting not tested</strong>: We added delays
between requests. Rapid-fire requests would likely trigger additional
blocking.</p></li>
<li><p><strong>Simple detection only</strong>: We only tested HTTP-level
blocking. JavaScript-based detection (like fingerprinting) was not
evaluated.</p></li>
<li><p><strong>Sample size</strong>: We tested ~200 user agents. The
full dataset has 5,000+ UAs.</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>Our analysis confirms that <strong>user agent selection
matters</strong> for web scraping success:</p>
<ul>
<li>
<strong>Recent user agents</strong> (last 6 months) have
<strong>20-40% higher success rates</strong> than older ones</li>
<li>
<strong>Chrome and Firefox</strong> user agents perform best across
most sites</li>
<li>
<strong>Crawler/bot UAs</strong> should be avoided for most scraping
tasks</li>
<li>The <strong>best strategy</strong> is to rotate among several
recent, mainstream browser UAs</li>
</ul>
<p>For production scraping, we recommend: 1. Using UAs from this
package’s regularly updated database 2. Filtering for
<code>last_visit</code> within the past 6 months 3. Preferring Chrome
&gt; Firefox &gt; Safari &gt; Opera 4. Rotating UAs and adding realistic
delays between requests</p>
<hr>
<p><em>Data last updated: 2026-01-14</em></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Benjamin Guinaudeau.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
